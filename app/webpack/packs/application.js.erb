import 'rails-ujs'

import Turbolinks from 'turbolinks'
Turbolinks.start()

import 'onsignal/dist/OneSignalSDK'
import OnSignal from 'onsignal'

let subscribeButton = document.querySelector('#subscribe a')
function showSubscription() {
  if (subscribeButton)
    subscribeButton.innerHTML = 'ðŸŽ‰ Thank you for subscribing! ðŸŽ‰'
}
document.addEventListener('DOMContentLoaded', () => {
  const onSignal = new OnSignal('<%= Rails.application.credentials.onesignal[:app_id] %>')
  if (onSignal.isSubscribed())
    showSubscription()
  else {
    if (subscribeButton) {
      subscribeButton.addEventListener('click', () => {
        onSignal.subscribe()
        showSubscription()
      })
    }
  }
})

import './../stylesheets/index'
