import 'rails-ujs';
// import './../javascripts/cable';

import Turbolinks from 'turbolinks';
Turbolinks.start();

import 'turbolinks-animate';
document.addEventListener( 'turbolinks:load', () => {
    TurbolinksAnimate.init({ element: document.querySelector('body.turbolinks-animate') });
})

import 'onsignal/dist/OneSignalSDK';
import OnSignal from 'onsignal';
function showSubscription() {
    document.querySelectorAll('#subscribe a.myg-button').innerHTML = 'ðŸŽ‰ Thank you for subscribing! ðŸŽ‰';
}
document.addEventListener( 'turbolinks:load', () => { // change to 'ready'
    const onSignal = new OnSignal('<%= Settings.onesignal.app_id %>');
    console.log(onSignal.isSubscribed());
    console.log(getCookieValue('oneSignalPlayerId'));
    if (onSignal.isSubscribed())
        showSubscription()
    else {
        document.querySelectorAll('#subscribe a.myg-button').forEach( (element) => element.addEventListener( 'click', () => {
            onSignal.subscribe();
            showSubscription();
        }));
    }
})
function getCookieValue(a) {
    let b = document.cookie.match('(^|;)\\s*' + a + '\\s*=\\s*([^;]+)');
    return b ? b.pop() : '';
}

import './../javascripts/myg/index';

import './../javascripts/packages/repositories/show';


import './../stylesheets/index';
